var f=(e=>(e[e.Off=0]="Off",e[e.Prompt=1]="Prompt",e[e.Always=2]="Always",e))(f||{}),b=(e=>(e[e.Char=0]="Char",e[e.WordRepeat=1]="WordRepeat",e))(b||{}),h=(e=>(e[e.None=0]="None",e[e.Refresh=1]="Refresh",e[e.WordReset=2]="WordReset",e[e.CharAdded=4]="CharAdded",e[e.NextWord=8]="NextWord",e[e.LessonCompleted=16]="LessonCompleted",e[e.MissedSpace=32]="MissedSpace",e))(h||{}),w=(e=>(e[e.Incomplete=0]="Incomplete",e[e.Active=1]="Active",e[e.Complete=2]="Complete",e[e.Error=3]="Error",e))(w||{});function g(){const e=matchMedia==null?void 0:matchMedia("(pointer:coarse)");if((e==null?void 0:e.media)==="(pointer:coarse)")return!!e.matches;if("orientation"in window)return!0;const o=navigator.userAgent;return/\b(BlackBerry|webOS|iPhone|IEMobile)\b/i.test(o)||/\b(Android|Windows Phone|iPad|iPod)\b/i.test(o)}function j(){return typeof window>"u"?!1:"virtualKeyboard"in navigator||"maxTouchPoints"in navigator&&navigator.maxTouchPoints>0||"msMaxTouchPoints"in navigator&&navigator.msMaxTouchPoints>0||g()}const p="default",I=j(),x={user:p,lastLesson:null,checkMode:b.Char,backspace:!0,wordBatchSize:50,minQueue:20,shortcuts:{stop:"F7",pause:"F4"},logStats:f.Always,caseSensitive:!I,nextCustomId:1,spaceOptional:!1,random:!0,until:100,adaptive:!1},P="titantutor",_=4,i="user_config",S="lesson_options",m="user_lessons",k="adaptive",y="lesson_stats",v=[{store:i,key:"user",autoIncrement:!1},{store:S,key:"lesson_id",autoIncrement:!1},{store:m,key:"id",autoIncrement:!0},{store:k,key:"lesson_id",autoIncrement:!1},{store:y,key:"lesson_id",autoIncrement:!1}];function l(e,o){e.createObjectStore(o.store,{keyPath:o.key,autoIncrement:o.autoIncrement}).createIndex(o.key,o.key,{unique:!0})}function O(){return new Promise((e,o)=>{const s=window.indexedDB.open(P,_);s.onsuccess=function(t){e(t.target.result)},s.onerror=function(t){o("could not connect to db")},s.onupgradeneeded=async t=>{const r=t.target.result,a=t.target.transaction;if(t.oldVersion<1)for(const n of v)l(r,n);else{if(t.oldVersion===1){const n=a.objectStore(i),c=n.get(p);c.onsuccess=d=>{const u=c.result;u.shortucts={stop:u.stop,pause:u.pause},u.stop=void 0,u.pause=void 0,n.put(u)},c.onerror=async d=>{r.deleteObjectStore(i),r.createObjectStore(i,{keyPath:"user"}).createIndex("user","user",{unique:!0})}}if(t.oldVersion<=2&&(r.deleteObjectStore(m),l(r,{store:m,key:"id",autoIncrement:!0}),l(r,{store:y,key:"lesson_id",autoIncrement:!1})),t.oldVersion<=3){const n=a.objectStore(i),c=n.get(p);c.onsuccess=d=>{const u=c.result;u!==void 0&&(u.logStats=u.logStats===!0?f.Always:f.Off,n.put(u))},c.onerror=()=>{r.deleteObjectStore(i),l(r,{store:i,key:"user",autoIncrement:!1})}}}}})}function q(e){for(const o of v)e.transaction(o.store,"readwrite").objectStore(o.store).clear()}function C(e,o,s){let t,r=!1;return new Promise((a,n)=>{const c=e.transaction(o,"readonly");c.oncomplete=()=>a(r?void 0:t),c.onerror=()=>a(void 0);const d=c.objectStore(o).get(s);d.onsuccess=()=>t=d.result,d.onerror=()=>r=!0})}function R(e,o,s){let t;return new Promise(r=>{const a=e.transaction([o],"readwrite");a.oncomplete=()=>r(t),a.onerror=()=>r(void 0);const n=a.objectStore(o).put(s);n.onsuccess=()=>{t=n.result}})}function W(e,o){let s,t=!1;return new Promise(r=>{const a=e.transaction([o],"readonly");a.oncomplete=()=>r(t?void 0:s),a.onerror=()=>r(void 0);const n=a.objectStore(o).getAll();n.onsuccess=()=>s=n.result,n.onerror=()=>t=!0})}function B(e,o,s){return new Promise(t=>{const r=e.transaction(o,"readwrite");r.oncomplete=()=>t(s),r.onerror=()=>t(void 0),r.objectStore(o).delete(s)})}export{h as A,b as C,w as L,q as a,y as b,O as c,R as d,S as e,p as f,C as g,i as h,x as i,k as j,W as l,B as r,m as u};
